<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Refrigerant Tracker – Cowboys AC</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="floating-bar">
    <div class="info-panels">
      <div>Installs Today: <span id="installs-count">0</span></div>
      <div id="current-datetime"></div>
      <div id="weather-info">72°F Sunny</div>
    </div>
    <a href="internal-dashboard.html" class="office-button btn">Office Use Only</a>
  </div>

  <div class="logo-container">
    <img src="assets/Cowboys_Logo.png" alt="Cowboys AC Logo" class="logo" />
  </div>

  <main class="container">
    <div class="testing-banner">FOR TESTING PURPOSES ONLY</div>
    <h1 style="text-align:center; margin-bottom:1.5rem;">Refrigerant Tracker</h1>
    <form id="tracker-form">
      <!-- wizard-grid as buttons -->
      <div class="wizard-grid" id="step-1">
        <button class="option-button" data-role="technician">Technician</button>
        <button class="option-button" data-role="installer">Installer</button>
      </div>
      <div class="wizard-grid" id="step-2" style="display:none;"></div>
      <div id="step-3" style="display:none; text-align:center;">
        <input type="text" id="invoice" placeholder="Invoice #" style="padding:.75rem; width:80%; font-size:1rem;" />
        <button id="next-3" class="btn" disabled>Next</button>
      </div>
      <div class="wizard-grid" id="step-4" style="display:none;"></div>
      <div class="wizard-grid" id="step-5" style="display:none;"></div>
      <div id="step-6" style="display:none; text-align:center;">
        <div class="quantity-control">
          <button id="decrease" class="btn">-</button>
          <input type="number" id="amount" value="0" step="0.5" min="0" max="25.5" readonly />
          <button id="increase" class="btn">+</button>
        </div>
        <button id="next-6" class="btn" disabled>Next</button>
      </div>
      <div id="step-7" style="display:none; text-align:center;">
        <input type="text" id="signature" placeholder="Type your name to sign" style="padding:.75rem; width:80%; font-size:1rem;" />
        <button id="submit-btn" class="btn" disabled>Submit</button>
      </div>
    </form>
  </main>

  <script src="script.js"></script>
  <script>
    function updateDateTime() {
      document.getElementById('current-datetime').textContent = new Date().toLocaleString();
    }
    setInterval(updateDateTime, 1000);
    updateDateTime();
    document.getElementById('weather-info').textContent = '72°F Sunny';

    // wizard logic...
    const steps = ['step-1','step-2','step-3','step-4','step-5','step-6','step-7'];
    let selectedRole, selectedEmployee, invoiceNum, refrigType;
    document.querySelectorAll('#step-1 .option-button').forEach(btn => {
      btn.onclick = () => { selectedRole = btn.dataset.role; initEmployees(); show('step-2'); };
    });
    function initEmployees() {
      const grid = document.getElementById('step-2');
      grid.innerHTML = '';
      for(let i=1;i<=15;i++){
        const b=document.createElement('button');
        b.className='option-button';
        b.textContent=`Employee ${i}`;
        b.onclick=()=>{ selectedEmployee=b.textContent; show('step-3'); };
        grid.appendChild(b);
      }
    }
    const inv=document.getElementById('invoice'), n3=document.getElementById('next-3');
    inv.oninput=()=>n3.disabled=!inv.value.trim();
    n3.onclick=()=>{invoiceNum=inv.value.trim(); initTypes(); show('step-4');};
    function initTypes(){
      const grid=document.getElementById('step-4'); grid.innerHTML='';
      ['R-410A','R-454B'].forEach(type=>{
        const b=document.createElement('button');
        b.className='option-button';
        b.textContent=type;
        b.onclick=()=>{ refrigType=type; initTanks(); show('step-5'); };
        grid.appendChild(b);
      });
    }
    function initTanks(){
      const grid=document.getElementById('step-5'); grid.innerHTML='';
      for(let i=1;i<=10;i++){
        const b=document.createElement('button');
        b.className='option-button';
        b.textContent=`Tank ${i}`;
        b.onclick=()=>{ grid.dataset.selectedTank=i; show('step-6'); };
        grid.appendChild(b);
      }
    }
    const amt=document.getElementById('amount'), n6=document.getElementById('next-6');
    document.getElementById('increase').onclick=()=>updateAmt(0.5);
    document.getElementById('decrease').onclick=()=>updateAmt(-0.5);
    function updateAmt(delta){
      let v=parseFloat(amt.value)+delta; v=Math.min(Math.max(v,0),25.5);
      amt.value=v.toFixed(1); n6.disabled=!(v>0);
    }
    n6.onclick=()=>show('step-7');
    const sig=document.getElementById('signature'), sub=document.getElementById('submit-btn');
    sig.oninput=()=>sub.disabled=!sig.value.trim();
    document.getElementById('tracker-form').addEventListener('submit',e=>{
      e.preventDefault();
      const tank= document.getElementById('step-5').dataset.selectedTank;
      const body = encodeURIComponent(
        `Role: ${selectedRole}\nEmployee: ${selectedEmployee}\nInvoice #: ${invoiceNum}\nType: ${refrigType}\nTank #: ${tank}\nAmount Used: ${amt.value} lbs\nSignature: ${sig.value.trim()}`
      );
      window.location.href=`mailto:warehouse@cowboysac.com,michael@cowboysac.com,alfonso@cowboysac.com?subject=${encodeURIComponent('Refrigerant Usage Log')}&body=${body}`;
    });
    function show(id){
      steps.forEach(s=>document.getElementById(s).style.display=(s===id?'grid':'none'));
    }
    show('step-1');
  </script>
</body>
</html>
